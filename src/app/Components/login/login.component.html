<main *ngIf="!initAuthSpinner">
    <div class="lateral"></div>
    <div class="login">
        <div class="p-4 d w-full lg:w-6" style="background-color: #f7fafb;">
            <div class="text-center mb-5">
                <img src="../../../assets/img/logo.png" alt="Image" height="100" style="border-radius: 50%;"
                    class="mb-3">
                <div class="text-900 text-3xl font-medium mb-3">Bienvenido</div>
            </div>
            <div>
                <label for="username" class="block text-900 font-medium mb-2">Usuario</label>
                <input id="username" type="text" name="username" [(ngModel)]="usuarioLoginDTO.username" pInputText
                    class="w-full mb-3" placeholder="Usuario">

                <label for="password1" class="block text-900 font-medium mb-2">Contraseña</label>
                <input id="password" type="password" name="password" [(ngModel)]="usuarioLoginDTO.password" pInputText
                    class="w-full mb-3" placeholder="*********">

                <div class="flex align-items-center justify-content-between mb-6">
                    <a class="font-medium no-underline ml-2 text-blue-500 text-right cursor-pointer"
                        (click)="openDialogRecoverPassword()">Olvido su contraseña?</a>
                </div>

                <button pButton (click)="singIn()" pRipple label="Sign In" icon="pi pi-user" class="w-full"></button>
            </div>
        </div>
    </div>
</main>

<!-- IMPLEMENT RECOVER PASSWORD -->
<p-dialog [(visible)]="dialogRecoverPassword" [style]="{ width: '450px', padding: screenWidth < 600 ? '10px' : '' }"
    header="Recuperación de Contraseña" [modal]="true" styleClass="p-fluid">
    <ng-template pTemplate="content">
        <form [formGroup]="formulario">
            <div class="field">
                <label for="email"><strong>Ingrese su correo electrónico.</strong></label>
                <input type="email" pInputText id="email" name="email" placeholder="Dirección de correo electrónico"
                    formControlName="email"
                    [class.is-invalid]="formulario.get('email')!.invalid && formulario.get('email')!.touched"
                    class="form-control" formcontrolname="email" required autofocus />

                <div
                    *ngIf="formulario.get('email')?.invalid && formulario.get('email')?.touched || formulario.get('email')?.dirty">
                    <small class="text-danger" *ngIf="formulario.get('email')?.errors?.['required']">Correo es
                        requerido.</small>
                    <small class="text-danger" *ngIf="formulario.get('email')?.errors?.['pattern']">Dirección de correo
                        invalido </small>
                </div>

                <div class="flex justify-content-center mt-4" *ngIf="!isEmpty(responseServer)">
                    <p-message
                        [severity]="responseServer.status === 200 ? 'success': responseServer.status === 404 ? 'warn':'error' "
                        [text]="responseServer.message"></p-message>
                </div>
            </div>
        </form>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Cancelar" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"
            [disabled]="submitted ? true : false"></button>
        <button pButton pRipple [label]="submitted ? 'Validando': 'Envíar'"
            [icon]="'pi '+(submitted ? 'pi-spin pi-spinner':'pi-check')" [disabled]="submitted ? true : false"
            class="p-button-text" (click)="sendRecoverPassword()"></button>
    </ng-template>
</p-dialog>

<p-dialog header="" [(visible)]="visibleRolnoAsignado" [modal]="true" [style]="{ width: '25vw', height: '10' }"
    [draggable]="false" [resizable]="false" [responsive]="true" [appendTo]="'body'">
    <div class="container p-fluid">
        <div class="card">
            <div class="card-header">
                <h2>¡Rol no asignado!</h2>
            </div>
            <div class="card-body">
                <p>Para acceder a esta funcionalidad, necesitas un rol asignado.</p>
                <p>Por favor, contacta a los administradores del sistema para solicitar el rol correspondiente.</p>
                <button pButton type="button" label="Contactar Administradores" icon="pi pi-envelope"></button>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog header="SELECCIONE UN ROL" [(visible)]="visibleListRoles" [modal]="true" [style]="{ width: '80vh'}"
    [draggable]="false" [resizable]="false" class="custom-dialog">
    <div class="surface-section text-center m-6">
        <div class="grid">
            <div class="select col-12 md:col-6 md:mb-4 mb-0 px-3" *ngFor="let list of roles">
                <span class="p-3 shadow-2 mb-3 inline-block surface-card"
                    style="border-radius: 10px; background-color: #4b99b4" (click)="guardarRolStorage(list.nombreRol!)">
                    <i class="pi pi-prime" [style.color]="list.nombreRol === 'ADMINISTRADOR' ? 'blue' : 'green'"
                        style="font-size: 50px;"></i>
                </span>
                <div class="text-900 text-xl mb-3 font-medium" style="color: #4b99b4">
                    {{list.nombreRol==='SUPERADMINISTRADOR' ? 'SUPERADMIN': list.nombreRol}}</div>
            </div>
        </div>
    </div>
</p-dialog>

<div class="centered-container" *ngIf="initAuthSpinner">
    <p-progressSpinner></p-progressSpinner>
    <p class="loading-text" style="font-size: 20px; color: #000;">
        <strong>Iniciando sesión</strong><span id="loading-dots"></span>
    </p>
</div>